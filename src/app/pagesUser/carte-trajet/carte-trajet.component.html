<ion-header collapse="fade">
  <ion-toolbar color="warning">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Votre trajet</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content fullscreen class="trajet-content">

  <!-- 📍 Carte pleine page -->
  <div class="map-fullscreen">
    <div id="map"></div>
    <div [class.loader-visible]="loading && !Livreur" class="loader-overlay">
      <ion-spinner name="crescent"></ion-spinner>
      <p>Recherche d’un livreur disponible...</p>
    </div>
  </div>

  <!-- 📦 Superposition des infos -->
  <div class="overlay-info">

    <!-- Infos trajet -->
    <div class="overlay-block" *ngIf="trajet && !loading">
      <div class="trajet-row">
        <ion-icon name="walk-outline" class="icon-color"></ion-icon>
        <span>Distance : {{ trajet.distance }} km</span>
      </div>
      <div class="trajet-row">
        <ion-icon name="time-outline" class="icon-color"></ion-icon>
        <span>Duree estimee : {{ trajet.duree }} min</span>
      </div>
      <div class="trajet-row">
        <ion-icon name="cash-outline" class="icon-color"></ion-icon>
        <span>Prix : {{ trajet.prix }} FCFA</span>
      </div>
    </div>

    <!-- Profil livreur -->
    <div class="overlay-block driver" *ngIf="Livreur">
      <div class="driver-info">
        <img *ngIf="Livreur.photoURL" [src]="Livreur.photoURL" alt="Livreur" class="driver-photo" />
        <div>
          <div class="driver-name">{{ Livreur.prenom }}</div>
          <div class="driver-role">{{ Livreur.role | titlecase }}</div>
        </div>
      </div>
      <div class="driver-actions">
        <ion-button class="btn-call" (click)="callLivreur()">
          <ion-icon name="call-outline" slot="start"></ion-icon>
          Appeler
        </ion-button>
        <!-- <ion-button class="btn-msg" (click)="messageLivreur()">
          <ion-icon name="chatbubble-outline" slot="start"></ion-icon>
          Message
        </ion-button> -->
      </div>
    </div>

    <!-- Bouton annuler -->
    <div class="cancel-text" (click)="annulerCommande()">Annuler</div>

    <!-- Annulation -->
    <div class="annulation" *ngIf="trajet?.statut === 'annulée'">
      <p class="motif">
        <strong>Motif d’annulation :</strong> {{ trajet.motifAnnulation }}
      </p>
      <p class="auteur">
        <strong>Annulé par :</strong>
        <span *ngIf="trajet.annulePar === 'client'">Client</span>
      </p>
    </div>

  </div>

</ion-content>
